package com.stayrascal.spark.kafka.decisionTree

import org.apache.spark.ml.Pipeline
import org.apache.spark.ml.classification.{DecisionTreeClassificationModel, DecisionTreeClassifier}
import org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator
import org.apache.spark.ml.feature.{IndexToString, StringIndexer, VectorAssembler, VectorIndexer}
import org.apache.spark.sql.{DataFrame, SparkSession}

object DecisionTreeClassifier {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession.builder().appName("Spark Decision Tree Classifier").master("local[*]").getOrCreate()

    val dataLabelDF: DataFrame = loadData(spark)

    val featuresArray = Array("gender", "age", "yearsmarried", "children", "religiousness", " education", "occupation", "rating")
    val assembler = new VectorAssembler().setInputCols(featuresArray).setOutputCol("features")
    val vecDF: DataFrame = assembler.transform(dataLabelDF)
    vecDF.show(10, truncate = false)

    val labelIndexer = new StringIndexer().setInputCol("label").setOutputCol("indexedLabel").fit(vecDF)
    labelIndexer.transform(vecDF).show(10, truncate = false)

    val featureIndexer = new VectorIndexer().setInputCol("features").setOutputCol("indexedFeatures").setMaxCategories(5).fit(vecDF)
    featureIndexer.transform(vecDF).show(10, truncate = false)

    val Array(trainingData, testData) = vecDF.randomSplit(Array(0.7, 0.3))
    val dt = new DecisionTreeClassifier()
      .setLabelCol("indexedLabel")
      .setFeaturesCol("indexedFeatures")
      .setImpurity("entropy") // 不纯度
      .setMaxBins(100) // 离散化"连续特征"的最大划分数
      .setMaxDepth(5) // 树的最大深度
      .setMinInfoGain(0.01) // 一个节点分裂的最小信息增益，值为【0，1】
      .setMinInstancesPerNode(10) // 每个节点包含的最小样本树
      .setSeed(123456)

    // Convert index label to original label
    val labelConverter = new IndexToString().setInputCol("prediction").setOutputCol("predictedLabel").setLabels(labelIndexer.labels)

    // Chain indexers and tree in a Pipeline.
    val pipeline = new Pipeline().setStages(Array(labelIndexer, featureIndexer, dt, labelConverter))

    // Train model, This also runs the indexers.
    val model = pipeline.fit(trainingData)

    // make prediction
    val predictions = model.transform(testData)

    predictions.select("predictedLabel", "label", "features").show(10, truncate = false)

    val evaluator = new MulticlassClassificationEvaluator().setLabelCol("indexedLabel").setPredictionCol("prediction").setMetricName("accuracy")
    val accuracy = evaluator.evaluate(predictions)
    println("Test Error = " + (1.9 - accuracy))

    val treeModel = model.stages(2).asInstanceOf[DecisionTreeClassificationModel]
    treeModel.getLabelCol
    treeModel.getFeaturesCol
    treeModel.featureImportances
    treeModel.getPredictionCol
    treeModel.getProbabilityCol

    treeModel.numClasses
    treeModel.numFeatures
    treeModel.depth
    treeModel.numNodes

    treeModel.getImpurity
    treeModel.getMaxBins
    treeModel.getMaxMemoryInMB
    treeModel.getMinInfoGain
    treeModel.getMinInstancesPerNode

    println("Leaned classification tree model: \n" + treeModel.toDebugString)

  }

  private def loadData(spark: SparkSession) = {
    import spark.implicits._

    val dataList: List[(Double, String, Double, Double, String, Double, Double, Double, Double)] = List(
      (0, "male", 37, 10, "no", 3, 18, 7, 4),
      (0, "female", 27, 4, "no", 4, 14, 6, 4),
      (0, "female", 32, 15, "yes", 1, 12, 1, 4),
      (0, "male", 57, 15, "yes", 5, 18, 6, 5),
      (0, "male", 22, 0.75, "no", 2, 17, 6, 3),
      (0, "female", 32, 1.5, "no", 2, 17, 5, 5),
      (0, "female", 22, 0.75, "no", 2, 12, 1, 3),
      (0, "male", 57, 15, "yes", 2, 14, 4, 4),
      (0, "female", 32, 15, "yes", 4, 16, 1, 2),
      (0, "male", 22, 1.5, "no", 4, 14, 4, 5),
      (0, "male", 37, 15, "yes", 2, 20, 7, 2),
      (0, "male", 27, 4, "yes", 4, 18, 6, 4),
      (0, "male", 47, 15, "yes", 5, 17, 6, 4),
      (0, "female", 22, 1.5, "no", 2, 17, 5, 4),
      (0, "female", 27, 4, "no", 4, 14, 5, 4),
      (0, "female", 37, 15, "yes", 1, 17, 5, 5),
      (0, "female", 37, 15, "yes", 2, 18, 4, 3),
      (0, "female", 22, 0.75, "no", 3, 16, 5, 4),
      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
      (0, "female", 27, 10, "yes", 2, 14, 1, 5),
      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
      (0, "female", 27, 10, "yes", 4, 16, 5, 4),
      (0, "female", 32, 10, "yes", 3, 14, 1, 5),
      (0, "male", 37, 4, "yes", 2, 20, 6, 4),
      (0, "female", 22, 1.5, "no", 2, 18, 5, 5),
      (0, "female", 27, 7, "no", 4, 16, 1, 5),
      (0, "male", 42, 15, "yes", 5, 20, 6, 4),
      (0, "male", 27, 4, "yes", 3, 16, 5, 5),
      (0, "female", 27, 4, "yes", 3, 17, 5, 4),
      (0, "male", 42, 15, "yes", 4, 20, 6, 3),
      (0, "female", 22, 1.5, "no", 3, 16, 5, 5),
      (0, "male", 27, 0.417, "no", 4, 17, 6, 4),
      (0, "female", 42, 15, "yes", 5, 14, 5, 4),
      (0, "male", 32, 4, "yes", 1, 18, 6, 4),
      (0, "female", 22, 1.5, "no", 4, 16, 5, 3),
      (0, "female", 42, 15, "yes", 3, 12, 1, 4),
      (0, "female", 22, 4, "no", 4, 17, 5, 5),
      (0, "male", 22, 1.5, "yes", 1, 14, 3, 5),
      (0, "female", 22, 0.75, "no", 3, 16, 1, 5),
      (0, "male", 32, 10, "yes", 5, 20, 6, 5),
      (0, "male", 52, 15, "yes", 5, 18, 6, 3),
      (0, "female", 22, 0.417, "no", 5, 14, 1, 4),
      (0, "female", 27, 4, "yes", 2, 18, 6, 1),
      (0, "female", 32, 7, "yes", 5, 17, 5, 3),
      (0, "male", 22, 4, "no", 3, 16, 5, 5),
      (0, "female", 27, 7, "yes", 4, 18, 6, 5),
      (0, "female", 42, 15, "yes", 2, 18, 5, 4),
      (0, "male", 27, 1.5, "yes", 4, 16, 3, 5),
      (0, "male", 42, 15, "yes", 2, 20, 6, 4),
      (0, "female", 22, 0.75, "no", 5, 14, 3, 5),
      (0, "male", 32, 7, "yes", 2, 20, 6, 4),
      (0, "male", 27, 4, "yes", 5, 20, 6, 5),
      (0, "male", 27, 10, "yes", 4, 20, 6, 4),
      (0, "male", 22, 4, "no", 1, 18, 5, 5),
      (0, "female", 37, 15, "yes", 4, 14, 3, 1),
      (0, "male", 22, 1.5, "yes", 5, 16, 4, 4),
      (0, "female", 37, 15, "yes", 4, 17, 1, 5),
      (0, "female", 27, 0.75, "no", 4, 17, 5, 4),
      (0, "male", 32, 10, "yes", 4, 20, 6, 4),
      (0, "female", 47, 15, "yes", 5, 14, 7, 2),
      (0, "male", 37, 10, "yes", 3, 20, 6, 4),
      (0, "female", 22, 0.75, "no", 2, 16, 5, 5),
      (0, "male", 27, 4, "no", 2, 18, 4, 5),
      (0, "male", 32, 7, "no", 4, 20, 6, 4),
      (0, "male", 42, 15, "yes", 2, 17, 3, 5),
      (0, "male", 37, 10, "yes", 4, 20, 6, 4),
      (0, "female", 47, 15, "yes", 3, 17, 6, 5),
      (0, "female", 22, 1.5, "no", 5, 16, 5, 5),
      (0, "female", 27, 1.5, "no", 2, 16, 6, 4),
      (0, "female", 27, 4, "no", 3, 17, 5, 5),
      (0, "female", 32, 10, "yes", 5, 14, 4, 5),
      (0, "female", 22, 0.125, "no", 2, 12, 5, 5),
      (0, "male", 47, 15, "yes", 4, 14, 4, 3),
      (0, "male", 32, 15, "yes", 1, 14, 5, 5),
      (0, "male", 27, 7, "yes", 4, 16, 5, 5),
      (0, "female", 22, 1.5, "yes", 3, 16, 5, 5),
      (0, "male", 27, 4, "yes", 3, 17, 6, 5),
      (0, "female", 22, 1.5, "no", 3, 16, 5, 5),
      (0, "male", 57, 15, "yes", 2, 14, 7, 2),
      (0, "male", 17.5, 1.5, "yes", 3, 18, 6, 5),
      (0, "male", 57, 15, "yes", 4, 20, 6, 5),
      (0, "female", 22, 0.75, "no", 2, 16, 3, 4),
      (0, "male", 42, 4, "no", 4, 17, 3, 3),
      (0, "female", 22, 1.5, "yes", 4, 12, 1, 5),
      (0, "female", 22, 0.417, "no", 1, 17, 6, 4),
      (0, "female", 32, 15, "yes", 4, 17, 5, 5),
      (0, "female", 27, 1.5, "no", 3, 18, 5, 2),
      (0, "female", 22, 1.5, "yes", 3, 14, 1, 5),
      (0, "female", 37, 15, "yes", 3, 14, 1, 4),
      (0, "female", 32, 15, "yes", 4, 14, 3, 4),
      (0, "male", 37, 10, "yes", 2, 14, 5, 3),
      (0, "male", 37, 10, "yes", 4, 16, 5, 4),
      (0, "male", 57, 15, "yes", 5, 20, 5, 3),
      (0, "male", 27, 0.417, "no", 1, 16, 3, 4),
      (0, "female", 42, 15, "yes", 5, 14, 1, 5),
      (0, "male", 57, 15, "yes", 3, 16, 6, 1),
      (0, "male", 37, 10, "yes", 1, 16, 6, 4),
      (0, "male", 37, 15, "yes", 3, 17, 5, 5),
      (0, "male", 37, 15, "yes", 4, 20, 6, 5),
      (0, "female", 27, 10, "yes", 5, 14, 1, 5),
      (0, "male", 37, 10, "yes", 2, 18, 6, 4),
      (0, "female", 22, 0.125, "no", 4, 12, 4, 5),
      (0, "male", 57, 15, "yes", 5, 20, 6, 5),
      (0, "female", 37, 15, "yes", 4, 18, 6, 4),
      (0, "male", 22, 4, "yes", 4, 14, 6, 4),
      (0, "male", 27, 7, "yes", 4, 18, 5, 4),
      (0, "male", 57, 15, "yes", 4, 20, 5, 4),
      (0, "male", 32, 15, "yes", 3, 14, 6, 3),
      (0, "female", 22, 1.5, "no", 2, 14, 5, 4),
      (0, "female", 32, 7, "yes", 4, 17, 1, 5),
      (0, "female", 37, 15, "yes", 4, 17, 6, 5),
      (0, "female", 32, 1.5, "no", 5, 18, 5, 5),
      (0, "male", 42, 10, "yes", 5, 20, 7, 4),
      (0, "female", 27, 7, "no", 3, 16, 5, 4),
      (0, "male", 37, 15, "no", 4, 20, 6, 5),
      (0, "male", 37, 15, "yes", 4, 14, 3, 2),
      (0, "male", 32, 10, "no", 5, 18, 6, 4),
      (0, "female", 22, 0.75, "no", 4, 16, 1, 5),
      (0, "female", 27, 7, "yes", 4, 12, 2, 4),
      (0, "female", 27, 7, "yes", 2, 16, 2, 5),
      (0, "female", 42, 15, "yes", 5, 18, 5, 4),
      (0, "male", 42, 15, "yes", 4, 17, 5, 3),
      (0, "female", 27, 7, "yes", 2, 16, 1, 2),
      (0, "female", 22, 1.5, "no", 3, 16, 5, 5),
      (0, "male", 37, 15, "yes", 5, 20, 6, 5),
      (0, "female", 22, 0.125, "no", 2, 14, 4, 5),
      (0, "male", 27, 1.5, "no", 4, 16, 5, 5),
      (0, "male", 32, 1.5, "no", 2, 18, 6, 5),
      (0, "male", 27, 1.5, "no", 2, 17, 6, 5),
      (0, "female", 27, 10, "yes", 4, 16, 1, 3),
      (0, "male", 42, 15, "yes", 4, 18, 6, 5),
      (0, "female", 27, 1.5, "no", 2, 16, 6, 5),
      (0, "male", 27, 4, "no", 2, 18, 6, 3),
      (0, "female", 32, 10, "yes", 3, 14, 5, 3),
      (0, "female", 32, 15, "yes", 3, 18, 5, 4),
      (0, "female", 22, 0.75, "no", 2, 18, 6, 5),
      (0, "female", 37, 15, "yes", 2, 16, 1, 4),
      (0, "male", 27, 4, "yes", 4, 20, 5, 5),
      (0, "male", 27, 4, "no", 1, 20, 5, 4),
      (0, "female", 27, 10, "yes", 2, 12, 1, 4),
      (0, "female", 32, 15, "yes", 5, 18, 6, 4),
      (0, "male", 27, 7, "yes", 5, 12, 5, 3),
      (0, "male", 52, 15, "yes", 2, 18, 5, 4),
      (0, "male", 27, 4, "no", 3, 20, 6, 3),
      (0, "male", 37, 4, "yes", 1, 18, 5, 4),
      (0, "male", 27, 4, "yes", 4, 14, 5, 4),
      (0, "female", 52, 15, "yes", 5, 12, 1, 3),
      (0, "female", 57, 15, "yes", 4, 16, 6, 4),
      (0, "male", 27, 7, "yes", 1, 16, 5, 4),
      (0, "male", 37, 7, "yes", 4, 20, 6, 3),
      (0, "male", 22, 0.75, "no", 2, 14, 4, 3),
      (0, "male", 32, 4, "yes", 2, 18, 5, 3),
      (0, "male", 37, 15, "yes", 4, 20, 6, 3),
      (0, "male", 22, 0.75, "yes", 2, 14, 4, 3),
      (0, "male", 42, 15, "yes", 4, 20, 6, 3),
      (0, "female", 52, 15, "yes", 5, 17, 1, 1),
      (0, "female", 37, 15, "yes", 4, 14, 1, 2),
      (0, "male", 27, 7, "yes", 4, 14, 5, 3),
      (0, "male", 32, 4, "yes", 2, 16, 5, 5),
      (0, "female", 27, 4, "yes", 2, 18, 6, 5),
      (0, "female", 27, 4, "yes", 2, 18, 5, 5),
      (0, "male", 37, 15, "yes", 5, 18, 6, 5),
      (0, "female", 47, 15, "yes", 5, 12, 5, 4),
      (0, "female", 32, 10, "yes", 3, 17, 1, 4),
      (0, "female", 27, 1.5, "yes", 4, 17, 1, 2),
      (0, "female", 57, 15, "yes", 2, 18, 5, 2),
      (0, "female", 22, 1.5, "no", 4, 14, 5, 4),
      (0, "male", 42, 15, "yes", 3, 14, 3, 4),
      (0, "male", 57, 15, "yes", 4, 9, 2, 2),
      (0, "male", 57, 15, "yes", 4, 20, 6, 5),
      (0, "female", 22, 0.125, "no", 4, 14, 4, 5),
      (0, "female", 32, 10, "yes", 4, 14, 1, 5),
      (0, "female", 42, 15, "yes", 3, 18, 5, 4),
      (0, "female", 27, 1.5, "no", 2, 18, 6, 5),
      (0, "male", 32, 0.125, "yes", 2, 18, 5, 2),
      (0, "female", 27, 4, "no", 3, 16, 5, 4),
      (0, "female", 27, 10, "yes", 2, 16, 1, 4),
      (0, "female", 32, 7, "yes", 4, 16, 1, 3),
      (0, "female", 37, 15, "yes", 4, 14, 5, 4),
      (0, "female", 42, 15, "yes", 5, 17, 6, 2),
      (0, "male", 32, 1.5, "yes", 4, 14, 6, 5),
      (0, "female", 32, 4, "yes", 3, 17, 5, 3),
      (0, "female", 37, 7, "no", 4, 18, 5, 5),
      (0, "female", 22, 0.417, "yes", 3, 14, 3, 5),
      (0, "female", 27, 7, "yes", 4, 14, 1, 5),
      (0, "male", 27, 0.75, "no", 3, 16, 5, 5),
      (0, "male", 27, 4, "yes", 2, 20, 5, 5),
      (0, "male", 32, 10, "yes", 4, 16, 4, 5),
      (0, "male", 32, 15, "yes", 1, 14, 5, 5),
      (0, "male", 22, 0.75, "no", 3, 17, 4, 5),
      (0, "female", 27, 7, "yes", 4, 17, 1, 4),
      (0, "male", 27, 0.417, "yes", 4, 20, 5, 4),
      (0, "male", 37, 15, "yes", 4, 20, 5, 4),
      (0, "female", 37, 15, "yes", 2, 14, 1, 3),
      (0, "male", 22, 4, "yes", 1, 18, 5, 4),
      (0, "male", 37, 15, "yes", 4, 17, 5, 3),
      (0, "female", 22, 1.5, "no", 2, 14, 4, 5),
      (0, "male", 52, 15, "yes", 4, 14, 6, 2),
      (0, "female", 22, 1.5, "no", 4, 17, 5, 5),
      (0, "male", 32, 4, "yes", 5, 14, 3, 5),
      (0, "male", 32, 4, "yes", 2, 14, 3, 5),
      (0, "female", 22, 1.5, "no", 3, 16, 6, 5),
      (0, "male", 27, 0.75, "no", 2, 18, 3, 3),
      (0, "female", 22, 7, "yes", 2, 14, 5, 2),
      (0, "female", 27, 0.75, "no", 2, 17, 5, 3),
      (0, "female", 37, 15, "yes", 4, 12, 1, 2),
      (0, "female", 22, 1.5, "no", 1, 14, 1, 5),
      (0, "female", 37, 10, "no", 2, 12, 4, 4),
      (0, "female", 37, 15, "yes", 4, 18, 5, 3),
      (0, "female", 42, 15, "yes", 3, 12, 3, 3),
      (0, "male", 22, 4, "no", 2, 18, 5, 5),
      (0, "male", 52, 7, "yes", 2, 20, 6, 2),
      (0, "male", 27, 0.75, "no", 2, 17, 5, 5),
      (0, "female", 27, 4, "no", 2, 17, 4, 5),
      (0, "male", 42, 1.5, "no", 5, 20, 6, 5),
      (0, "male", 22, 1.5, "no", 4, 17, 6, 5),
      (0, "male", 22, 4, "no", 4, 17, 5, 3),
      (0, "female", 22, 4, "yes", 1, 14, 5, 4),
      (0, "male", 37, 15, "yes", 5, 20, 4, 5),
      (0, "female", 37, 10, "yes", 3, 16, 6, 3),
      (0, "male", 42, 15, "yes", 4, 17, 6, 5),
      (0, "female", 47, 15, "yes", 4, 17, 5, 5),
      (0, "male", 22, 1.5, "no", 4, 16, 5, 4),
      (0, "female", 32, 10, "yes", 3, 12, 1, 4),
      (0, "female", 22, 7, "yes", 1, 14, 3, 5),
      (0, "female", 32, 10, "yes", 4, 17, 5, 4),
      (0, "male", 27, 1.5, "yes", 2, 16, 2, 4),
      (0, "male", 37, 15, "yes", 4, 14, 5, 5),
      (0, "male", 42, 4, "yes", 3, 14, 4, 5),
      (0, "female", 37, 15, "yes", 5, 14, 5, 4),
      (0, "female", 32, 7, "yes", 4, 17, 5, 5),
      (0, "female", 42, 15, "yes", 4, 18, 6, 5),
      (0, "male", 27, 4, "no", 4, 18, 6, 4),
      (0, "male", 22, 0.75, "no", 4, 18, 6, 5),
      (0, "male", 27, 4, "yes", 4, 14, 5, 3),
      (0, "female", 22, 0.75, "no", 5, 18, 1, 5),
      (0, "female", 52, 15, "yes", 5, 9, 5, 5),
      (0, "male", 32, 10, "yes", 3, 14, 5, 5),
      (0, "female", 37, 15, "yes", 4, 16, 4, 4),
      (0, "male", 32, 7, "yes", 2, 20, 5, 4),
      (0, "female", 42, 15, "yes", 3, 18, 1, 4),
      (0, "male", 32, 15, "yes", 1, 16, 5, 5),
      (0, "male", 27, 4, "yes", 3, 18, 5, 5),
      (0, "female", 32, 15, "yes", 4, 12, 3, 4),
      (0, "male", 22, 0.75, "yes", 3, 14, 2, 4),
      (0, "female", 22, 1.5, "no", 3, 16, 5, 3),
      (0, "female", 42, 15, "yes", 4, 14, 3, 5),
      (0, "female", 52, 15, "yes", 3, 16, 5, 4),
      (0, "male", 37, 15, "yes", 5, 20, 6, 4),
      (0, "female", 47, 15, "yes", 4, 12, 2, 3),
      (0, "male", 57, 15, "yes", 2, 20, 6, 4),
      (0, "male", 32, 7, "yes", 4, 17, 5, 5),
      (0, "female", 27, 7, "yes", 4, 17, 1, 4),
      (0, "male", 22, 1.5, "no", 1, 18, 6, 5),
      (0, "female", 22, 4, "yes", 3, 9, 1, 4),
      (0, "female", 22, 1.5, "no", 2, 14, 1, 5),
      (0, "male", 42, 15, "yes", 2, 20, 6, 4),
      (0, "male", 57, 15, "yes", 4, 9, 2, 4),
      (0, "female", 27, 7, "yes", 2, 18, 1, 5),
      (0, "female", 22, 4, "yes", 3, 14, 1, 5),
      (0, "male", 37, 15, "yes", 4, 14, 5, 3),
      (0, "male", 32, 7, "yes", 1, 18, 6, 4),
      (0, "female", 22, 1.5, "no", 2, 14, 5, 5),
      (0, "female", 22, 1.5, "yes", 3, 12, 1, 3),
      (0, "male", 52, 15, "yes", 2, 14, 5, 5),
      (0, "female", 37, 15, "yes", 2, 14, 1, 1),
      (0, "female", 32, 10, "yes", 2, 14, 5, 5),
      (0, "male", 42, 15, "yes", 4, 20, 4, 5),
      (0, "female", 27, 4, "yes", 3, 18, 4, 5),
      (0, "male", 37, 15, "yes", 4, 20, 6, 5),
      (0, "male", 27, 1.5, "no", 3, 18, 5, 5),
      (0, "female", 22, 0.125, "no", 2, 16, 6, 3),
      (0, "male", 32, 10, "yes", 2, 20, 6, 3),
      (0, "female", 27, 4, "no", 4, 18, 5, 4),
      (0, "female", 27, 7, "yes", 2, 12, 5, 1),
      (0, "male", 32, 4, "yes", 5, 18, 6, 3),
      (0, "female", 37, 15, "yes", 2, 17, 5, 5),
      (0, "male", 47, 15, "no", 4, 20, 6, 4),
      (0, "male", 27, 1.5, "no", 1, 18, 5, 5),
      (0, "male", 37, 15, "yes", 4, 20, 6, 4),
      (0, "female", 32, 15, "yes", 4, 18, 1, 4),
      (0, "female", 32, 7, "yes", 4, 17, 5, 4),
      (0, "female", 42, 15, "yes", 3, 14, 1, 3),
      (0, "female", 27, 7, "yes", 3, 16, 1, 4),
      (0, "male", 27, 1.5, "no", 3, 16, 4, 2),
      (0, "male", 22, 1.5, "no", 3, 16, 3, 5),
      (0, "male", 27, 4, "yes", 3, 16, 4, 2),
      (0, "female", 27, 7, "yes", 3, 12, 1, 2),
      (0, "female", 37, 15, "yes", 2, 18, 5, 4),
      (0, "female", 37, 7, "yes", 3, 14, 4, 4),
      (0, "male", 22, 1.5, "no", 2, 16, 5, 5),
      (0, "male", 37, 15, "yes", 5, 20, 5, 4),
      (0, "female", 22, 1.5, "no", 4, 16, 5, 3),
      (0, "female", 32, 10, "yes", 4, 16, 1, 5),
      (0, "male", 27, 4, "no", 2, 17, 5, 3),
      (0, "female", 22, 0.417, "no", 4, 14, 5, 5),
      (0, "female", 27, 4, "no", 2, 18, 5, 5),
      (0, "male", 37, 15, "yes", 4, 18, 5, 3),
      (0, "male", 37, 10, "yes", 5, 20, 7, 4),
      (0, "female", 27, 7, "yes", 2, 14, 4, 2),
      (0, "male", 32, 4, "yes", 2, 16, 5, 5),
      (0, "male", 32, 4, "yes", 2, 16, 6, 4),
      (0, "male", 22, 1.5, "no", 3, 18, 4, 5),
      (0, "female", 22, 4, "yes", 4, 14, 3, 4),
      (0, "female", 17.5, 0.75, "no", 2, 18, 5, 4),
      (0, "male", 32, 10, "yes", 4, 20, 4, 5),
      (0, "female", 32, 0.75, "no", 5, 14, 3, 3),
      (0, "male", 37, 15, "yes", 4, 17, 5, 3),
      (0, "male", 32, 4, "no", 3, 14, 4, 5),
      (0, "female", 27, 1.5, "no", 2, 17, 3, 2),
      (0, "female", 22, 7, "yes", 4, 14, 1, 5),
      (0, "male", 47, 15, "yes", 5, 14, 6, 5),
      (0, "male", 27, 4, "yes", 1, 16, 4, 4),
      (0, "female", 37, 15, "yes", 5, 14, 1, 3),
      (0, "male", 42, 4, "yes", 4, 18, 5, 5),
      (0, "female", 32, 4, "yes", 2, 14, 1, 5),
      (0, "male", 52, 15, "yes", 2, 14, 7, 4),
      (0, "female", 22, 1.5, "no", 2, 16, 1, 4),
      (0, "male", 52, 15, "yes", 4, 12, 2, 4),
      (0, "female", 22, 0.417, "no", 3, 17, 1, 5),
      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
      (0, "male", 27, 4, "yes", 4, 20, 6, 4),
      (0, "female", 32, 15, "yes", 4, 14, 1, 5),
      (0, "female", 27, 1.5, "no", 2, 16, 3, 5),
      (0, "male", 32, 4, "no", 1, 20, 6, 5),
      (0, "male", 37, 15, "yes", 3, 20, 6, 4),
      (0, "female", 32, 10, "no", 2, 16, 6, 5),
      (0, "female", 32, 10, "yes", 5, 14, 5, 5),
      (0, "male", 37, 1.5, "yes", 4, 18, 5, 3),
      (0, "male", 32, 1.5, "no", 2, 18, 4, 4),
      (0, "female", 32, 10, "yes", 4, 14, 1, 4),
      (0, "female", 47, 15, "yes", 4, 18, 5, 4),
      (0, "female", 27, 10, "yes", 5, 12, 1, 5),
      (0, "male", 27, 4, "yes", 3, 16, 4, 5),
      (0, "female", 37, 15, "yes", 4, 12, 4, 2),
      (0, "female", 27, 0.75, "no", 4, 16, 5, 5),
      (0, "female", 37, 15, "yes", 4, 16, 1, 5),
      (0, "female", 32, 15, "yes", 3, 16, 1, 5),
      (0, "female", 27, 10, "yes", 2, 16, 1, 5),
      (0, "male", 27, 7, "no", 2, 20, 6, 5),
      (0, "female", 37, 15, "yes", 2, 14, 1, 3),
      (0, "male", 27, 1.5, "yes", 2, 17, 4, 4),
      (0, "female", 22, 0.75, "yes", 2, 14, 1, 5),
      (0, "male", 22, 4, "yes", 4, 14, 2, 4),
      (0, "male", 42, 0.125, "no", 4, 17, 6, 4),
      (0, "male", 27, 1.5, "yes", 4, 18, 6, 5),
      (0, "male", 27, 7, "yes", 3, 16, 6, 3),
      (0, "female", 52, 15, "yes", 4, 14, 1, 3),
      (0, "male", 27, 1.5, "no", 5, 20, 5, 2),
      (0, "female", 27, 1.5, "no", 2, 16, 5, 5),
      (0, "female", 27, 1.5, "no", 3, 17, 5, 5),
      (0, "male", 22, 0.125, "no", 5, 16, 4, 4),
      (0, "female", 27, 4, "yes", 4, 16, 1, 5),
      (0, "female", 27, 4, "yes", 4, 12, 1, 5),
      (0, "female", 47, 15, "yes", 2, 14, 5, 5),
      (0, "female", 32, 15, "yes", 3, 14, 5, 3),
      (0, "male", 42, 7, "yes", 2, 16, 5, 5),
      (0, "male", 22, 0.75, "no", 4, 16, 6, 4),
      (0, "male", 27, 0.125, "no", 3, 20, 6, 5),
      (0, "male", 32, 10, "yes", 3, 20, 6, 5),
      (0, "female", 22, 0.417, "no", 5, 14, 4, 5),
      (0, "female", 47, 15, "yes", 5, 14, 1, 4),
      (0, "female", 32, 10, "yes", 3, 14, 1, 5),
      (0, "male", 57, 15, "yes", 4, 17, 5, 5),
      (0, "male", 27, 4, "yes", 3, 20, 6, 5),
      (0, "female", 32, 7, "yes", 4, 17, 1, 5),
      (0, "female", 37, 10, "yes", 4, 16, 1, 5),
      (0, "female", 32, 10, "yes", 1, 18, 1, 4),
      (0, "female", 22, 4, "no", 3, 14, 1, 4),
      (0, "female", 27, 7, "yes", 4, 14, 3, 2),
      (0, "male", 57, 15, "yes", 5, 18, 5, 2),
      (0, "male", 32, 7, "yes", 2, 18, 5, 5),
      (0, "female", 27, 1.5, "no", 4, 17, 1, 3),
      (0, "male", 22, 1.5, "no", 4, 14, 5, 5),
      (0, "female", 22, 1.5, "yes", 4, 14, 5, 4),
      (0, "female", 32, 7, "yes", 3, 16, 1, 5),
      (0, "female", 47, 15, "yes", 3, 16, 5, 4),
      (0, "female", 22, 0.75, "no", 3, 16, 1, 5),
      (0, "female", 22, 1.5, "yes", 2, 14, 5, 5),
      (0, "female", 27, 4, "yes", 1, 16, 5, 5),
      (0, "male", 52, 15, "yes", 4, 16, 5, 5),
      (0, "male", 32, 10, "yes", 4, 20, 6, 5),
      (0, "male", 47, 15, "yes", 4, 16, 6, 4),
      (0, "female", 27, 7, "yes", 2, 14, 1, 2),
      (0, "female", 22, 1.5, "no", 4, 14, 4, 5),
      (0, "female", 32, 10, "yes", 2, 16, 5, 4),
      (0, "female", 22, 0.75, "no", 2, 16, 5, 4),
      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
      (0, "female", 42, 15, "yes", 3, 18, 6, 4),
      (0, "female", 27, 7, "yes", 5, 14, 4, 5),
      (0, "male", 42, 15, "yes", 4, 16, 4, 4),
      (0, "female", 57, 15, "yes", 3, 18, 5, 2),
      (0, "male", 42, 15, "yes", 3, 18, 6, 2),
      (0, "female", 32, 7, "yes", 2, 14, 1, 2),
      (0, "male", 22, 4, "no", 5, 12, 4, 5),
      (0, "female", 22, 1.5, "no", 1, 16, 6, 5),
      (0, "female", 22, 0.75, "no", 1, 14, 4, 5),
      (0, "female", 32, 15, "yes", 4, 12, 1, 5),
      (0, "male", 22, 1.5, "no", 2, 18, 5, 3),
      (0, "male", 27, 4, "yes", 5, 17, 2, 5),
      (0, "female", 27, 4, "yes", 4, 12, 1, 5),
      (0, "male", 42, 15, "yes", 5, 18, 5, 4),
      (0, "male", 32, 1.5, "no", 2, 20, 7, 3),
      (0, "male", 57, 15, "no", 4, 9, 3, 1),
      (0, "male", 37, 7, "no", 4, 18, 5, 5),
      (0, "male", 52, 15, "yes", 2, 17, 5, 4),
      (0, "male", 47, 15, "yes", 4, 17, 6, 5),
      (0, "female", 27, 7, "no", 2, 17, 5, 4),
      (0, "female", 27, 7, "yes", 4, 14, 5, 5),
      (0, "female", 22, 4, "no", 2, 14, 3, 3),
      (0, "male", 37, 7, "yes", 2, 20, 6, 5),
      (0, "male", 27, 7, "no", 4, 12, 4, 3),
      (0, "male", 42, 10, "yes", 4, 18, 6, 4),
      (0, "female", 22, 1.5, "no", 3, 14, 1, 5),
      (0, "female", 22, 4, "yes", 2, 14, 1, 3),
      (0, "female", 57, 15, "no", 4, 20, 6, 5),
      (0, "male", 37, 15, "yes", 4, 14, 4, 3),
      (0, "female", 27, 7, "yes", 3, 18, 5, 5),
      (0, "female", 17.5, 10, "no", 4, 14, 4, 5),
      (0, "male", 22, 4, "yes", 4, 16, 5, 5),
      (0, "female", 27, 4, "yes", 2, 16, 1, 4),
      (0, "female", 37, 15, "yes", 2, 14, 5, 1),
      (0, "female", 22, 1.5, "no", 5, 14, 1, 4),
      (0, "male", 27, 7, "yes", 2, 20, 5, 4),
      (0, "male", 27, 4, "yes", 4, 14, 5, 5),
      (0, "male", 22, 0.125, "no", 1, 16, 3, 5),
      (0, "female", 27, 7, "yes", 4, 14, 1, 4),
      (0, "female", 32, 15, "yes", 5, 16, 5, 3),
      (0, "male", 32, 10, "yes", 4, 18, 5, 4),
      (0, "female", 32, 15, "yes", 2, 14, 3, 4),
      (0, "female", 22, 1.5, "no", 3, 17, 5, 5),
      (0, "male", 27, 4, "yes", 4, 17, 4, 4),
      (0, "female", 52, 15, "yes", 5, 14, 1, 5),
      (0, "female", 27, 7, "yes", 2, 12, 1, 2),
      (0, "female", 27, 7, "yes", 3, 12, 1, 4),
      (0, "female", 42, 15, "yes", 2, 14, 1, 4),
      (0, "female", 42, 15, "yes", 4, 14, 5, 4),
      (0, "male", 27, 7, "yes", 4, 14, 3, 3),
      (0, "male", 27, 7, "yes", 2, 20, 6, 2),
      (0, "female", 42, 15, "yes", 3, 12, 3, 3),
      (0, "male", 27, 4, "yes", 3, 16, 3, 5),
      (0, "female", 27, 7, "yes", 3, 14, 1, 4),
      (0, "female", 22, 1.5, "no", 2, 14, 4, 5),
      (0, "female", 27, 4, "yes", 4, 14, 1, 4),
      (0, "female", 22, 4, "no", 4, 14, 5, 5),
      (0, "female", 22, 1.5, "no", 2, 16, 4, 5),
      (0, "male", 47, 15, "no", 4, 14, 5, 4),
      (0, "male", 37, 10, "yes", 2, 18, 6, 2),
      (0, "male", 37, 15, "yes", 3, 17, 5, 4),
      (0, "female", 27, 4, "yes", 2, 16, 1, 4),
      (3, "male", 27, 1.5, "no", 3, 18, 4, 4),
      (3, "female", 27, 4, "yes", 3, 17, 1, 5),
      (7, "male", 37, 15, "yes", 5, 18, 6, 2),
      (12, "female", 32, 10, "yes", 3, 17, 5, 2),
      (1, "male", 22, 0.125, "no", 4, 16, 5, 5),
      (1, "female", 22, 1.5, "yes", 2, 14, 1, 5),
      (12, "male", 37, 15, "yes", 4, 14, 5, 2),
      (7, "female", 22, 1.5, "no", 2, 14, 3, 4),
      (2, "male", 37, 15, "yes", 2, 18, 6, 4),
      (3, "female", 32, 15, "yes", 4, 12, 3, 2),
      (1, "female", 37, 15, "yes", 4, 14, 4, 2),
      (7, "female", 42, 15, "yes", 3, 17, 1, 4),
      (12, "female", 42, 15, "yes", 5, 9, 4, 1),
      (12, "male", 37, 10, "yes", 2, 20, 6, 2),
      (12, "female", 32, 15, "yes", 3, 14, 1, 2),
      (3, "male", 27, 4, "no", 1, 18, 6, 5),
      (7, "male", 37, 10, "yes", 2, 18, 7, 3),
      (7, "female", 27, 4, "no", 3, 17, 5, 5),
      (1, "male", 42, 15, "yes", 4, 16, 5, 5),
      (1, "female", 47, 15, "yes", 5, 14, 4, 5),
      (7, "female", 27, 4, "yes", 3, 18, 5, 4),
      (1, "female", 27, 7, "yes", 5, 14, 1, 4),
      (12, "male", 27, 1.5, "yes", 3, 17, 5, 4),
      (12, "female", 27, 7, "yes", 4, 14, 6, 2),
      (3, "female", 42, 15, "yes", 4, 16, 5, 4),
      (7, "female", 27, 10, "yes", 4, 12, 7, 3),
      (1, "male", 27, 1.5, "no", 2, 18, 5, 2),
      (1, "male", 32, 4, "no", 4, 20, 6, 4),
      (1, "female", 27, 7, "yes", 3, 14, 1, 3),
      (3, "female", 32, 10, "yes", 4, 14, 1, 4),
      (3, "male", 27, 4, "yes", 2, 18, 7, 2),
      (1, "female", 17.5, 0.75, "no", 5, 14, 4, 5),
      (1, "female", 32, 10, "yes", 4, 18, 1, 5),
      (7, "female", 32, 7, "yes", 2, 17, 6, 4),
      (7, "male", 37, 15, "yes", 2, 20, 6, 4),
      (7, "female", 37, 10, "no", 1, 20, 5, 3),
      (12, "female", 32, 10, "yes", 2, 16, 5, 5),
      (7, "male", 52, 15, "yes", 2, 20, 6, 4),
      (7, "female", 42, 15, "yes", 1, 12, 1, 3),
      (1, "male", 52, 15, "yes", 2, 20, 6, 3),
      (2, "male", 37, 15, "yes", 3, 18, 6, 5),
      (12, "female", 22, 4, "no", 3, 12, 3, 4),
      (12, "male", 27, 7, "yes", 1, 18, 6, 2),
      (1, "male", 27, 4, "yes", 3, 18, 5, 5),
      (12, "male", 47, 15, "yes", 4, 17, 6, 5),
      (12, "female", 42, 15, "yes", 4, 12, 1, 1),
      (7, "male", 27, 4, "no", 3, 14, 3, 4),
      (7, "female", 32, 7, "yes", 4, 18, 4, 5),
      (1, "male", 32, 0.417, "yes", 3, 12, 3, 4),
      (3, "male", 47, 15, "yes", 5, 16, 5, 4),
      (12, "male", 37, 15, "yes", 2, 20, 5, 4),
      (7, "male", 22, 4, "yes", 2, 17, 6, 4),
      (1, "male", 27, 4, "no", 2, 14, 4, 5),
      (7, "female", 52, 15, "yes", 5, 16, 1, 3),
      (1, "male", 27, 4, "no", 3, 14, 3, 3),
      (1, "female", 27, 10, "yes", 4, 16, 1, 4),
      (1, "male", 32, 7, "yes", 3, 14, 7, 4),
      (7, "male", 32, 7, "yes", 2, 18, 4, 1),
      (3, "male", 22, 1.5, "no", 1, 14, 3, 2),
      (7, "male", 22, 4, "yes", 3, 18, 6, 4),
      (7, "male", 42, 15, "yes", 4, 20, 6, 4),
      (2, "female", 57, 15, "yes", 1, 18, 5, 4),
      (7, "female", 32, 4, "yes", 3, 18, 5, 2),
      (1, "male", 27, 4, "yes", 1, 16, 4, 4),
      (7, "male", 32, 7, "yes", 4, 16, 1, 4),
      (2, "male", 57, 15, "yes", 1, 17, 4, 4),
      (7, "female", 42, 15, "yes", 4, 14, 5, 2),
      (7, "male", 37, 10, "yes", 1, 18, 5, 3),
      (3, "male", 42, 15, "yes", 3, 17, 6, 1),
      (1, "female", 52, 15, "yes", 3, 14, 4, 4),
      (2, "female", 27, 7, "yes", 3, 17, 5, 3),
      (12, "male", 32, 7, "yes", 2, 12, 4, 2),
      (1, "male", 22, 4, "no", 4, 14, 2, 5),
      (3, "male", 27, 7, "yes", 3, 18, 6, 4),
      (12, "female", 37, 15, "yes", 1, 18, 5, 5),
      (7, "female", 32, 15, "yes", 3, 17, 1, 3),
      (7, "female", 27, 7, "no", 2, 17, 5, 5),
      (1, "female", 32, 7, "yes", 3, 17, 5, 3),
      (1, "male", 32, 1.5, "yes", 2, 14, 2, 4),
      (12, "female", 42, 15, "yes", 4, 14, 1, 2),
      (7, "male", 32, 10, "yes", 3, 14, 5, 4),
      (7, "male", 37, 4, "yes", 1, 20, 6, 3),
      (1, "female", 27, 4, "yes", 2, 16, 5, 3),
      (12, "female", 42, 15, "yes", 3, 14, 4, 3),
      (1, "male", 27, 10, "yes", 5, 20, 6, 5),
      (12, "male", 37, 10, "yes", 2, 20, 6, 2),
      (12, "female", 27, 7, "yes", 1, 14, 3, 3),
      (3, "female", 27, 7, "yes", 4, 12, 1, 2),
      (3, "male", 32, 10, "yes", 2, 14, 4, 4),
      (12, "female", 17.5, 0.75, "yes", 2, 12, 1, 3),
      (12, "female", 32, 15, "yes", 3, 18, 5, 4),
      (2, "female", 22, 7, "no", 4, 14, 4, 3),
      (1, "male", 32, 7, "yes", 4, 20, 6, 5),
      (7, "male", 27, 4, "yes", 2, 18, 6, 2),
      (1, "female", 22, 1.5, "yes", 5, 14, 5, 3),
      (12, "female", 32, 15, "no", 3, 17, 5, 1),
      (12, "female", 42, 15, "yes", 2, 12, 1, 2),
      (7, "male", 42, 15, "yes", 3, 20, 5, 4),
      (12, "male", 32, 10, "no", 2, 18, 4, 2),
      (12, "female", 32, 15, "yes", 3, 9, 1, 1),
      (7, "male", 57, 15, "yes", 5, 20, 4, 5),
      (12, "male", 47, 15, "yes", 4, 20, 6, 4),
      (2, "female", 42, 15, "yes", 2, 17, 6, 3),
      (12, "male", 37, 15, "yes", 3, 17, 6, 3),
      (12, "male", 37, 15, "yes", 5, 17, 5, 2),
      (7, "male", 27, 10, "yes", 2, 20, 6, 4),
      (2, "male", 37, 15, "yes", 2, 16, 5, 4),
      (12, "female", 32, 15, "yes", 1, 14, 5, 2),
      (7, "male", 32, 10, "yes", 3, 17, 6, 3),
      (2, "male", 37, 15, "yes", 4, 18, 5, 1),
      (7, "female", 27, 1.5, "no", 2, 17, 5, 5),
      (3, "female", 47, 15, "yes", 2, 17, 5, 2),
      (12, "male", 37, 15, "yes", 2, 17, 5, 4),
      (12, "female", 27, 4, "no", 2, 14, 5, 5),
      (2, "female", 27, 10, "yes", 4, 14, 1, 5),
      (1, "female", 22, 4, "yes", 3, 16, 1, 3),
      (12, "male", 52, 7, "no", 4, 16, 5, 5),
      (2, "female", 27, 4, "yes", 1, 16, 3, 5),
      (7, "female", 37, 15, "yes", 2, 17, 6, 4),
      (2, "female", 27, 4, "no", 1, 17, 3, 1),
      (12, "female", 17.5, 0.75, "yes", 2, 12, 3, 5),
      (7, "female", 32, 15, "yes", 5, 18, 5, 4),
      (7, "female", 22, 4, "no", 1, 16, 3, 5),
      (2, "male", 32, 4, "yes", 4, 18, 6, 4),
      (1, "female", 22, 1.5, "yes", 3, 18, 5, 2),
      (3, "female", 42, 15, "yes", 2, 17, 5, 4),
      (1, "male", 32, 7, "yes", 4, 16, 4, 4),
      (12, "male", 37, 15, "no", 3, 14, 6, 2),
      (1, "male", 42, 15, "yes", 3, 16, 6, 3),
      (1, "male", 27, 4, "yes", 1, 18, 5, 4),
      (2, "male", 37, 15, "yes", 4, 20, 7, 3),
      (7, "male", 37, 15, "yes", 3, 20, 6, 4),
      (3, "male", 22, 1.5, "no", 2, 12, 3, 3),
      (3, "male", 32, 4, "yes", 3, 20, 6, 2),
      (2, "male", 32, 15, "yes", 5, 20, 6, 5),
      (12, "female", 52, 15, "yes", 1, 18, 5, 5),
      (12, "male", 47, 15, "no", 1, 18, 6, 5),
      (3, "female", 32, 15, "yes", 4, 16, 4, 4),
      (7, "female", 32, 15, "yes", 3, 14, 3, 2),
      (7, "female", 27, 7, "yes", 4, 16, 1, 2),
      (12, "male", 42, 15, "yes", 3, 18, 6, 2),
      (7, "female", 42, 15, "yes", 2, 14, 3, 2),
      (12, "male", 27, 7, "yes", 2, 17, 5, 4),
      (3, "male", 32, 10, "yes", 4, 14, 4, 3),
      (7, "male", 47, 15, "yes", 3, 16, 4, 2),
      (1, "male", 22, 1.5, "yes", 1, 12, 2, 5),
      (7, "female", 32, 10, "yes", 2, 18, 5, 4),
      (2, "male", 32, 10, "yes", 2, 17, 6, 5),
      (2, "male", 22, 7, "yes", 3, 18, 6, 2),
      (1, "female", 32, 15, "yes", 3, 14, 1, 5))

    val data = dataList.toDF("affairs", "gender", "age", "yearsmarried", "children", "religiousness", "education", "occupation", "rating")
    data.createOrReplaceTempView("data")

    val labelWhere = "case when affairs=0 then 0 else cast(1 as double) end as label"
    val genderWhere = "case when gender='female' then 0 else cast(1 as double) end as gender"
    val childrenWhere = "case when children='no' then 0 else cast(1 as double) end as children"

    val dataLabelDF = spark.sql(s"select $labelWhere, $genderWhere, age, yearsmarrried, $childrenWhere, religiousness, education, occupation, rating from data")
    dataLabelDF
  }
}
